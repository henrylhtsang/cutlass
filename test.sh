rm ~/cutlass/output.log
cd ~/cutlass/build

export CUDA_VISIBLE_DEVICES=7
# export REF_PRINT_DIFF=1

cmake .. -DCUTLASS_NVCC_ARCHS=100a

# Record start time for e2e timing
start_time=$(date +%s)
echo "E2E Test Run Started at: $(date)" | tee -a ~/cutlass/output.log

targets=(
    test_examples_77_blackwell_fmha_fp8
    test_examples_77_blackwell_fmha_fp8/fast
    test_examples_77_blackwell_fmha_fp8_test_basic
    test_examples_77_blackwell_fmha_fp8_test_basic/fast
    test_examples_77_blackwell_fmha_fp8_test_causal
    test_examples_77_blackwell_fmha_fp8_test_causal/fast
    test_examples_77_blackwell_fmha_fp8_test_local
    test_examples_77_blackwell_fmha_fp8_test_local/fast
    test_examples_77_blackwell_fmha_fp8_test_local_01
    test_examples_77_blackwell_fmha_fp8_test_local_01/fast
    test_examples_77_blackwell_fmha_fp8_test_local_02
    test_examples_77_blackwell_fmha_fp8_test_local_02/fast
    test_examples_77_blackwell_fmha_fp8_test_local_03
    test_examples_77_blackwell_fmha_fp8_test_local_03/fast
    test_examples_77_blackwell_fmha_fp8_test_local_04
    test_examples_77_blackwell_fmha_fp8_test_local_04/fast
    test_examples_77_blackwell_fmha_fp8_test_local_05
    test_examples_77_blackwell_fmha_fp8_test_local_05/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen
    test_examples_77_blackwell_fmha_fp8_test_varlen/fast
    test_examples_77_blackwell_fmha_fp8_test_hdim64
    test_examples_77_blackwell_fmha_fp8_test_hdim64/fast
    test_examples_77_blackwell_fmha_fp8_test_gqa
    test_examples_77_blackwell_fmha_fp8_test_gqa/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_00
    test_examples_77_blackwell_fmha_fp8_test_varlen_00/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_01
    test_examples_77_blackwell_fmha_fp8_test_varlen_01/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_02
    test_examples_77_blackwell_fmha_fp8_test_varlen_02/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_03
    test_examples_77_blackwell_fmha_fp8_test_varlen_03/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_04
    test_examples_77_blackwell_fmha_fp8_test_varlen_04/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_05
    test_examples_77_blackwell_fmha_fp8_test_varlen_05/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_06
    test_examples_77_blackwell_fmha_fp8_test_varlen_06/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_07
    test_examples_77_blackwell_fmha_fp8_test_varlen_07/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_08
    test_examples_77_blackwell_fmha_fp8_test_varlen_08/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_09
    test_examples_77_blackwell_fmha_fp8_test_varlen_09/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_10
    test_examples_77_blackwell_fmha_fp8_test_varlen_10/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_11
    test_examples_77_blackwell_fmha_fp8_test_varlen_11/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_12
    test_examples_77_blackwell_fmha_fp8_test_varlen_12/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_13
    test_examples_77_blackwell_fmha_fp8_test_varlen_13/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_14
    test_examples_77_blackwell_fmha_fp8_test_varlen_14/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_15
    test_examples_77_blackwell_fmha_fp8_test_varlen_15/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_16
    test_examples_77_blackwell_fmha_fp8_test_varlen_16/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_17
    test_examples_77_blackwell_fmha_fp8_test_varlen_17/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_18
    test_examples_77_blackwell_fmha_fp8_test_varlen_18/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_19
    test_examples_77_blackwell_fmha_fp8_test_varlen_19/fast
    test_examples_77_blackwell_fmha_fp8_test_varlen_20
    test_examples_77_blackwell_fmha_fp8_test_varlen_20/fast
    test_examples_77_blackwell_fmha_gen_fp8
    test_examples_77_blackwell_fmha_gen_fp8/fast
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_basic
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_basic/fast
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_varlen
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_varlen/fast
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_gqa
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_gqa/fast
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_remap
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_remap/fast
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_cacheonly
    test_examples_77_blackwell_fmha_gen_fp8_test_gen_cacheonly/fast
    test_examples_77_blackwell_fmha_bwd_fp8
    test_examples_77_blackwell_fmha_bwd_fp8/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_basic
    test_examples_77_blackwell_fmha_bwd_fp8_test_basic/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_00
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_00/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_01
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_01/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_02
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_02/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_03
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_03/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_04
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_04/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_05
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_05/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_06
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_06/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_07
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_07/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_08
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_08/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_09
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_09/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_10
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_10/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_11
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_11/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_12
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_12/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_13
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_13/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_14
    test_examples_77_blackwell_fmha_bwd_fp8_test_varlen_14/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_bwd_mla_basic
    test_examples_77_blackwell_fmha_bwd_fp8_test_bwd_mla_basic/fast
    test_examples_77_blackwell_fmha_bwd_fp8_test_bwd_mla_varlen
    test_examples_77_blackwell_fmha_bwd_fp8_test_bwd_mla_varlen/fast
    test_examples_77_blackwell_fmha_fp16
    test_examples_77_blackwell_fmha_fp16/fast
    test_examples_77_blackwell_fmha_fp16_test_basic
    test_examples_77_blackwell_fmha_fp16_test_basic/fast
    test_examples_77_blackwell_fmha_fp16_test_causal
    test_examples_77_blackwell_fmha_fp16_test_causal/fast
    test_examples_77_blackwell_fmha_fp16_test_local
    test_examples_77_blackwell_fmha_fp16_test_local/fast
    test_examples_77_blackwell_fmha_fp16_test_local_01
    test_examples_77_blackwell_fmha_fp16_test_local_01/fast
    test_examples_77_blackwell_fmha_fp16_test_local_02
    test_examples_77_blackwell_fmha_fp16_test_local_02/fast
    test_examples_77_blackwell_fmha_fp16_test_local_03
    test_examples_77_blackwell_fmha_fp16_test_local_03/fast
    test_examples_77_blackwell_fmha_fp16_test_local_04
    test_examples_77_blackwell_fmha_fp16_test_local_04/fast
    test_examples_77_blackwell_fmha_fp16_test_local_05
    test_examples_77_blackwell_fmha_fp16_test_local_05/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen
    test_examples_77_blackwell_fmha_fp16_test_varlen/fast
    test_examples_77_blackwell_fmha_fp16_test_hdim64
    test_examples_77_blackwell_fmha_fp16_test_hdim64/fast
    test_examples_77_blackwell_fmha_fp16_test_gqa
    test_examples_77_blackwell_fmha_fp16_test_gqa/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_00
    test_examples_77_blackwell_fmha_fp16_test_varlen_00/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_01
    test_examples_77_blackwell_fmha_fp16_test_varlen_01/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_02
    test_examples_77_blackwell_fmha_fp16_test_varlen_02/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_03
    test_examples_77_blackwell_fmha_fp16_test_varlen_03/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_04
    test_examples_77_blackwell_fmha_fp16_test_varlen_04/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_05
    test_examples_77_blackwell_fmha_fp16_test_varlen_05/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_06
    test_examples_77_blackwell_fmha_fp16_test_varlen_06/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_07
    test_examples_77_blackwell_fmha_fp16_test_varlen_07/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_08
    test_examples_77_blackwell_fmha_fp16_test_varlen_08/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_09
    test_examples_77_blackwell_fmha_fp16_test_varlen_09/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_10
    test_examples_77_blackwell_fmha_fp16_test_varlen_10/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_11
    test_examples_77_blackwell_fmha_fp16_test_varlen_11/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_12
    test_examples_77_blackwell_fmha_fp16_test_varlen_12/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_13
    test_examples_77_blackwell_fmha_fp16_test_varlen_13/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_14
    test_examples_77_blackwell_fmha_fp16_test_varlen_14/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_15
    test_examples_77_blackwell_fmha_fp16_test_varlen_15/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_16
    test_examples_77_blackwell_fmha_fp16_test_varlen_16/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_17
    test_examples_77_blackwell_fmha_fp16_test_varlen_17/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_18
    test_examples_77_blackwell_fmha_fp16_test_varlen_18/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_19
    test_examples_77_blackwell_fmha_fp16_test_varlen_19/fast
    test_examples_77_blackwell_fmha_fp16_test_varlen_20
    test_examples_77_blackwell_fmha_fp16_test_varlen_20/fast
    test_examples_77_blackwell_fmha_gen_fp16
    test_examples_77_blackwell_fmha_gen_fp16/fast
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_basic
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_basic/fast
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_varlen
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_varlen/fast
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_gqa
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_gqa/fast
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_remap
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_remap/fast
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_cacheonly
    test_examples_77_blackwell_fmha_gen_fp16_test_gen_cacheonly/fast
    test_examples_77_blackwell_fmha_bwd_fp16
    test_examples_77_blackwell_fmha_bwd_fp16/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_basic
    test_examples_77_blackwell_fmha_bwd_fp16_test_basic/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_00
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_00/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_01
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_01/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_02
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_02/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_03
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_03/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_04
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_04/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_05
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_05/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_06
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_06/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_07
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_07/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_08
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_08/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_09
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_09/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_10
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_10/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_11
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_11/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_12
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_12/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_13
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_13/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_14
    test_examples_77_blackwell_fmha_bwd_fp16_test_varlen_14/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_bwd_mla_basic
    test_examples_77_blackwell_fmha_bwd_fp16_test_bwd_mla_basic/fast
    test_examples_77_blackwell_fmha_bwd_fp16_test_bwd_mla_varlen
    test_examples_77_blackwell_fmha_bwd_fp16_test_bwd_mla_varlen/fast
    test_examples_77_blackwell_fmha_bfloat16
    test_examples_77_blackwell_fmha_bfloat16/fast
    test_examples_77_blackwell_fmha_bfloat16_test_basic
    test_examples_77_blackwell_fmha_bfloat16_test_basic/fast
    test_examples_77_blackwell_fmha_bfloat16_test_causal
    test_examples_77_blackwell_fmha_bfloat16_test_causal/fast
    test_examples_77_blackwell_fmha_bfloat16_test_local
    test_examples_77_blackwell_fmha_bfloat16_test_local/fast
    test_examples_77_blackwell_fmha_bfloat16_test_local_01
    test_examples_77_blackwell_fmha_bfloat16_test_local_01/fast
    test_examples_77_blackwell_fmha_bfloat16_test_local_02
    test_examples_77_blackwell_fmha_bfloat16_test_local_02/fast
    test_examples_77_blackwell_fmha_bfloat16_test_local_03
    test_examples_77_blackwell_fmha_bfloat16_test_local_03/fast
    test_examples_77_blackwell_fmha_bfloat16_test_local_04
    test_examples_77_blackwell_fmha_bfloat16_test_local_04/fast
    test_examples_77_blackwell_fmha_bfloat16_test_local_05
    test_examples_77_blackwell_fmha_bfloat16_test_local_05/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen
    test_examples_77_blackwell_fmha_bfloat16_test_varlen/fast
    test_examples_77_blackwell_fmha_bfloat16_test_hdim64
    test_examples_77_blackwell_fmha_bfloat16_test_hdim64/fast
    test_examples_77_blackwell_fmha_bfloat16_test_gqa
    test_examples_77_blackwell_fmha_bfloat16_test_gqa/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_00
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_00/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_01
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_01/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_02
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_02/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_03
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_03/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_04
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_04/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_05
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_05/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_06
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_06/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_07
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_07/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_08
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_08/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_09
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_09/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_10
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_10/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_11
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_11/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_12
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_12/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_13
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_13/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_14
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_14/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_15
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_15/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_16
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_16/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_17
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_17/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_18
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_18/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_19
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_19/fast
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_20
    test_examples_77_blackwell_fmha_bfloat16_test_varlen_20/fast
    test_examples_77_blackwell_fmha_gen_bfloat16
    test_examples_77_blackwell_fmha_gen_bfloat16/fast
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_basic
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_basic/fast
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_varlen
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_varlen/fast
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_gqa
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_gqa/fast
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_remap
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_remap/fast
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_cacheonly
    test_examples_77_blackwell_fmha_gen_bfloat16_test_gen_cacheonly/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16
    test_examples_77_blackwell_fmha_bwd_bfloat16/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_basic
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_basic/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_00
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_00/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_01
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_01/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_02
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_02/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_03
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_03/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_04
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_04/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_05
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_05/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_06
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_06/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_07
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_07/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_08
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_08/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_09
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_09/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_10
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_10/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_11
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_11/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_12
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_12/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_13
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_13/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_14
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_varlen_14/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_bwd_mla_basic
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_bwd_mla_basic/fast
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_bwd_mla_varlen
    test_examples_77_blackwell_fmha_bwd_bfloat16_test_bwd_mla_varlen/fast
)

for test in "${targets[@]}"
do
    echo "Running $test"
    CUDA_VISIBLE_DEVICES=7 make $test  2>&1 | tee -a ~/cutlass/output.log
done

# Record end time and calculate e2e duration
end_time=$(date +%s)
duration=$((end_time - start_time))

echo "E2E Test Run Completed at: $(date)" | tee -a ~/cutlass/output.log
echo "Total E2E Duration: ${duration} seconds" | tee -a ~/cutlass/output.log

unset CUDA_VISIBLE_DEVICES
unset REF_PRINT_DIFF
